# NFS filesystem mounting			-*- shell-script -*-

# FIXME This needs error checking

# Paramter: Where the root should be mounted
mountroot ()
{
	log_begin_msg "Running /scripts/nfs-top"
	run_scripts /scripts/nfs-top
	log_end_msg

	modprobe nfs
	# For DHCP
	modprobe af_packet

	ipconfig ${DEVICE}
	. /tmp/net-${DEVICE}.conf
	if [ "x${NFSROOT}" = "xauto" ]; then
		NFSROOT=${ROOTSERVER}:${ROOTPATH}
	fi

	log_begin_msg "Running /scripts/nfs-premount"
	run_scripts /scripts/nfs-premount
	log_end_msg

	if [ ${readonly} = y ]; then
		roflag="-o ro"
	else
		roflag="-o rw"
	fi

	nfsmount ${roflag} ${NFSROOT} ${rootmnt}

	log_begin_msg "Running /scripts/nfs-bottom"
	run_scripts /scripts/nfs-bottom
	log_end_msg

}
